// ============================================================
// ðŸ”¥ TENY SCRIPT : ULTIMATE STRESS TEST
// ============================================================

$>titre("âš ï¸ TEST DE PERFORMANCE EXTRÃŠME")
$>dom_inject_banner("Analyse de stabilitÃ© en cours...", "#d50000")

// ------------------------------------------------------------
// 1. TEST DE CALCUL INTENSIF (CPU)
// ------------------------------------------------------------
$>print("1. DÃ©marrage du Burn Test CPU...", "orange")

$>var total = 0
$>var i = 0

// On tente 1000 itÃ©rations avec des maths Ã  chaque tour
// Cela gÃ©nÃ¨re ~3000 opÃ©rations internes (parsing + eval + set)
$>repeat(1000) {
    $>var i = $>math($i + 1)
    $>var x = $>math(sqrt($i) * 10)
    $>var total = $>math($total + $x)
}

$>print("âœ… CPU Test fini. RÃ©sultat : " + $total, "lime")
$>espace(10)

// ------------------------------------------------------------
// 2. TEST MÃ‰MOIRE (String Explosion)
// ------------------------------------------------------------
$>print("2. Test MÃ©moire (Croissance Exponentielle)...", "orange")

$>var chaine = "X"
$>var tour = 0

// 2^13 = 8192 caractÃ¨res. 
// Attention : monter plus haut peut crasher si MAX_OPS est bas.
$>repeat(13) {
    $>var chaine = $chaine + $chaine
    $>var tour = $>math($tour + 1)
    $>print("  -> Tour " + $tour + " : taille " + $>len($chaine))
}

$>print("âœ… MÃ©moire OK. ChaÃ®ne finale gÃ©nÃ©rÃ©e.", "lime")
$>espace(10)

// ------------------------------------------------------------
// 3. TEST DE RENDU (DOM Flood)
// ------------------------------------------------------------
$>print("3. Inondation du Panneau (DOM Flood)...", "orange")
$>wait(1000)

// Affiche 500 lignes rapidement pour voir si le scroll tient
$>var k = 0
$>repeat(500) {
    $>print("Log systÃ¨me rapide ligne nÂ°" + $k, "#333")
    $>var k = $>math($k + 1)
}

$>print("âœ… DOM Flood terminÃ©.", "lime")
$>espace(10)

// ------------------------------------------------------------
// 4. TEST DE FONCTION (RÃ©cursivitÃ© & Scope)
// ------------------------------------------------------------
$>print("4. Test de Fonctions...", "orange")

// DÃ©finition d'une fonction personnalisÃ©e
$>def carre(x) {
    $>var res = $>math($x * $x)
    $>return $res
}

$>var val = 12
$>var res_func = $>carre($val)

$>print("Calcul via fonction : 12Â² = " + $res_func)
$>if($res_func == 144) {
    $>print("âœ… Fonctions OK", "lime")
} $>else {
    $>print("âŒ Erreur Fonctions", "red")
}

// ------------------------------------------------------------
// CONCLUSION
// ------------------------------------------------------------
$>wait(500)
$>titre("RÃ‰SULTAT DU DIAGNOSTIC")
$>dom_style("#preview-frame", "background", "#111")
$>dom_style("#preview-frame", "color", "#eee")
$>print("Si vous lisez ceci, votre moteur a survÃ©cu.", "#00e676")
$>alerte("Fin du protocole.")